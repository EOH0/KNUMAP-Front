(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2936:(e,n,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(6873)}])},3078:e=>{e.exports={hero:"Hero_hero__D0Vj7",image:"Hero_image__nZVM8",float:"Hero_float__LrCyg",title:"Hero_title__GxnES",subtitle:"Hero_subtitle__h66Po"}},6873:(e,n,t)=>{"use strict";t.r(n),t.d(n,{default:()=>m});var a=t(7876),r=t(7328),l=t.n(r),o=t(4232),i=t(9099),s=t(8819),c=t.n(s),d=t(1162),u=t(1724),p=t(4234),h=t(3078),_=t.n(h);function x(){return(0,a.jsxs)("div",{className:_().hero,children:[(0,a.jsx)("img",{src:"/data/image/cat.png",alt:"귀여운 고양이",className:_().image}),(0,a.jsx)("h1",{className:_().title,children:"경북대 장소 검색"}),(0,a.jsx)("p",{className:_().subtitle,children:"내 주변의 맛집과 시설을 한 눈에!"})]})}var f=t(8144);function m(){let e=(0,i.useRouter)(),n=(0,o.useContext)(d.R),[t,r]=(0,o.useState)([]),[s,h]=(0,o.useState)([]),[_,m]=(0,o.useState)([]),[g,j]=(0,o.useState)(!1),[v,b]=(0,o.useState)(""),[y,w]=(0,o.useState)([]),[M,N]=(0,o.useState)([]),[C,D]=(0,o.useState)(!1),[S,k]=(0,o.useState)(""),[E,R]=(0,o.useState)(""),[B,I]=(0,o.useState)(""),L=new f.A(t,{keys:["name","위치","분야"],threshold:.3});(0,o.useEffect)(()=>{fetch("/data/places.json").then(e=>e.json()).then(e=>r(e)).catch(e=>{console.error("장소 데이터 불러오기 실패:",e),r([])})},[]);let T=async()=>{try{let e=await fetch("/api/loadReviews"),t=await e.json(),a=Array.isArray(t.reviews)?t.reviews:[];if(h(a),n){let e=a.filter(e=>e.user===n.email);m(e)}}catch(e){console.error("리뷰 데이터 불러오기 실패:",e),h([]),m([])}};(0,o.useEffect)(()=>{T()},[n]),(0,o.useEffect)(()=>{let n=e=>{"/"===e&&(console.log("[DEBUG] 메인으로 이동됨 → 리뷰 리로드"),T())};return e.events.on("routeChangeComplete",n),()=>e.events.off("routeChangeComplete",n)},[e]),(0,o.useEffect)(()=>{if(n&&1){let e="favorites_".concat(n.uid),t=localStorage.getItem(e);N(t?JSON.parse(t):[])}},[n]),(0,o.useEffect)(()=>{n&&localStorage.setItem("favorites_".concat(n.uid),JSON.stringify(M))},[M,n]),(0,o.useEffect)(()=>{w(O(t.filter(e=>(!S||e.위치===S)&&(!E||e.분야===E))))},[t,B,S,E,s]),(0,o.useEffect)(()=>{let e=()=>{window.scrollY>300?j(!0):j(!1)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);let A=e=>{if(!n)return void alert("즐겨찾기는 로그인한 사용자만 이용할 수 있습니다.");let t="favorites_".concat(n.uid),a=M.find(n=>n.url===e.url)?M.filter(n=>n.url!==e.url):[...M,e];N(a),localStorage.setItem(t,JSON.stringify(a))},H=e=>M.some(n=>n.url===e),z=e=>{let n=s.filter(n=>n.placeId===e).map(e=>e.rating);return 0===n.length?0:n.reduce((e,n)=>e+n,0)/n.length},F=e=>!!n&&_.some(n=>n.placeId===e),P=()=>{if(!v.trim())return void w(t.filter(e=>(!S||e.위치===S)&&(!E||e.분야===E)));w(L.search(v).map(e=>e.item).filter(e=>(!S||e.위치===S)&&(!E||e.분야===E)))},V=e=>{let n=new Date(e);return(new Date-n)/864e5<=7},O=e=>{let n=[...e];return"찜순"===B?n.sort((e,n)=>M.filter(e=>e.url===n.url).length-M.filter(n=>n.url===e.url).length):"리뷰순"===B?n.sort((e,n)=>s.filter(e=>e.placeId===n.url).length-s.filter(n=>n.placeId===e.url).length):"평점순"===B?n.sort((e,n)=>z(n.url)-z(e.url)):"이름순"===B?n.sort((e,n)=>e.name.localeCompare(n.name,"ko",{sensitivity:"base"})):"최신순"===B&&n.sort((e,n)=>new Date(n.createdAt)-new Date(e.createdAt)),n};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsx)("title",{children:"KNUMAP"}),(0,a.jsx)("meta",{name:"description",content:"KNUMAP 메인화면"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsxs)("header",{className:"".concat(c().header," ").concat(g?c().headerVisible:c().headerHidden),children:[(0,a.jsx)("div",{className:c().logo,onClick:()=>e.push("/"),children:"KNUMAP"}),(0,a.jsxs)("nav",{className:c().menu,children:[(0,a.jsx)("button",{onClick:()=>e.push("/partner"),children:"제휴"}),(0,a.jsx)("button",{onClick:()=>e.push("/social"),children:"소셜"}),(0,a.jsx)("button",{onClick:()=>{e.push({pathname:"/favorite",query:{data:encodeURIComponent(JSON.stringify(M))}})},children:"즐겨찾기"})]}),(0,a.jsx)("div",{className:c().userMenu,children:n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("a",{href:"#",onClick:n=>{n.preventDefault(),e.push("/profile")},children:"내 정보"}),(0,a.jsx)("span",{style:{margin:"0 6px"},children:"|"}),(0,a.jsx)("a",{href:"#",onClick:async t=>{t.preventDefault(),localStorage.removeItem("favorites_".concat(n.uid)),await (0,u.CI)(p.j),N([]),alert("로그아웃 되었습니다."),e.push("/")},children:"로그아웃"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("a",{href:"#",onClick:n=>{n.preventDefault(),e.push("/login")},children:"로그인"}),(0,a.jsx)("span",{style:{margin:"0 6px"},children:"|"}),(0,a.jsx)("a",{href:"#",onClick:n=>{n.preventDefault(),e.push("/signup")},children:"회원가입"})]})})]}),(0,a.jsx)(x,{}),(0,a.jsxs)("main",{className:c().main,children:[(0,a.jsxs)("div",{style:{textAlign:"center",marginTop:"40px"},children:[(0,a.jsx)("input",{value:v,onChange:e=>b(e.target.value),onKeyDown:e=>{"Enter"===e.key&&P()},className:c().searchInput,placeholder:"찾으실려는 장소를 입력해주세요.",style:{padding:"10px 16px",borderRadius:"24px",border:"1px solid #ccc",width:"280px",fontSize:"16px",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s"},onMouseEnter:e=>{e.target.style.borderColor="#D90E15",e.target.style.boxShadow="0 0 5px rgba(217, 14, 21, 0.3)"},onMouseLeave:e=>{e.target.style.borderColor="#ccc",e.target.style.boxShadow="none"}}),(0,a.jsx)("button",{onClick:P,className:c().searchBtn,style:{marginLeft:"8px",border:"none",background:"none",fontSize:"20px",cursor:"pointer",transition:"transform 0.2s"},onMouseEnter:e=>e.currentTarget.style.transform="scale(1.2)",onMouseLeave:e=>e.currentTarget.style.transform="scale(1)",children:"\uD83D\uDD0D"}),(0,a.jsx)("button",{className:c().searchBtn,style:{marginLeft:"4px",border:"none",background:"none",fontSize:"20px",cursor:"pointer",transition:"transform 0.2s"},onClick:()=>D(!C),onMouseEnter:e=>e.currentTarget.style.transform="rotate(20deg)",onMouseLeave:e=>e.currentTarget.style.transform="rotate(0deg)",children:"\uD83D\uDD26"})]}),(0,a.jsx)("div",{style:{marginTop:"12px",textAlign:"center"},children:(0,a.jsxs)("select",{value:B,onChange:e=>I(e.target.value),style:{padding:"6px 10px",borderRadius:"12px",border:"1px solid #ddd",fontSize:"14px"},children:[(0,a.jsx)("option",{value:"",children:"정렬 없음"}),(0,a.jsx)("option",{value:"찜순",children:"찜 많은 순"}),(0,a.jsx)("option",{value:"리뷰순",children:"리뷰 많은 순"}),(0,a.jsx)("option",{value:"평점순",children:"평점 높은 순"}),(0,a.jsx)("option",{value:"이름순",children:"이름순"}),(0,a.jsx)("option",{value:"최신순",children:"최신 등록순"})]})}),C&&(0,a.jsxs)("div",{style:{margin:"12px auto",padding:"20px",width:"320px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(8px)",borderRadius:"20px",boxShadow:"0 8px 20px rgba(0, 0, 0, 0.12)",border:"1px solid #eee",transition:"all 0.3s ease-in-out",display:"flex",flexDirection:"column",gap:"16px",zIndex:999},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"6px",display:"block"},children:"\uD83E\uDDED 위치 필터"}),(0,a.jsxs)("select",{value:S,onChange:e=>k(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:"14px",border:"1px solid #ddd",backgroundColor:"#fff",fontSize:"15px",transition:"border-color 0.2s ease-in-out",outline:"none"},onMouseEnter:e=>e.target.style.borderColor="#D90E15",onMouseLeave:e=>e.target.style.borderColor="#ddd",children:[(0,a.jsx)("option",{value:"",children:"전체 위치"}),["정문","쪽문","서문","북문","농장문","텍문","동문","교내"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{style:{fontWeight:"bold",fontSize:"14px",marginBottom:"6px",display:"block"},children:"\uD83C\uDF7D️ 분야 필터"}),(0,a.jsxs)("select",{value:E,onChange:e=>R(e.target.value),style:{width:"100%",padding:"10px 14px",borderRadius:"14px",border:"1px solid #ddd",backgroundColor:"#fff",fontSize:"15px",transition:"border-color 0.2s ease-in-out",outline:"none"},onMouseEnter:e=>e.target.style.borderColor="#D90E15",onMouseLeave:e=>e.target.style.borderColor="#ddd",children:[(0,a.jsx)("option",{value:"",children:"전체 분야"}),["카페","음식점","편의점"].map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})]}),(0,a.jsx)("div",{className:c().contentRow,children:(0,a.jsxs)("section",{className:c().leftPanel,children:[(0,a.jsx)("div",{className:c().tabRow}),0===y.length?(0,a.jsx)("div",{style:{color:"#bbb",marginTop:40,textAlign:"center"},children:"검색 결과가 없습니다."}):y.map(t=>{let r=z(t.url),l=r>=4.5?c().highRating:r<3?c().lowRating:"";return(0,a.jsxs)("div",{className:"".concat(c().placeCard," ").concat(l),children:[(0,a.jsxs)("div",{className:c().placeHeader,children:[(0,a.jsx)("img",{src:"/data/image/".concat(t.name.replace(/\s/g,"_"),".jpg"),alt:"장소 이미지",className:c().placeLogo,onError:e=>{e.target.onerror=null,e.target.src="/data/image.jpg"}}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:c().placeName,children:t.name}),t.name,t.createdAt&&V(t.createdAt)&&(0,a.jsx)("span",{className:c().newBadge,children:"NEW"}),(0,a.jsx)("div",{style:{marginTop:4},children:t.phone?(0,a.jsxs)("a",{href:"tel:".concat(t.phone),style:{color:"#555",fontSize:"14px",textDecoration:"none"},children:["\uD83D\uDCDE ",t.phone]}):(0,a.jsx)("span",{style:{color:"#999",fontSize:"14px"},children:"전화번호 없음"})}),(0,a.jsx)("div",{className:c().placeType,children:t.type})]}),(0,a.jsx)("button",{className:"".concat(c().starBtn," ").concat(H(t.url)?c().favOn:""),onClick:()=>A(t),children:"★"})]}),(0,a.jsxs)("div",{className:c().placeInfo,children:[(0,a.jsxs)("div",{children:["리뷰 수 ",(0,a.jsxs)("span",{className:c().infoNum,children:[s.filter(e=>e.placeId===t.url).length,"명"]})]}),(0,a.jsxs)("div",{children:["평균 평점 ",(0,a.jsxs)("span",{className:c().infoNum,children:[r.toFixed(1)," / 5"," ",[1,2,3,4,5].map(e=>(0,a.jsx)("span",{style:{color:r>=e?"#D90E15":"#ccc",fontSize:18},children:"★"},e))]})]})]}),(0,a.jsxs)("div",{className:c().placeFooter,children:[(0,a.jsx)("button",{className:c().linkBtn,onClick:()=>window.open(t.url,"_blank"),children:"홈페이지"}),(0,a.jsx)("button",{className:c().linkBtn,onClick:()=>{if(!n||!n)return void alert("로그인이 필요합니다.");(!F(t.url)||confirm("이미 리뷰를 작성하셨습니다. 수정하시겠습니까?"))&&e.push({pathname:"/review",query:{placeId:t.url}})},children:"지도 리뷰"})]})]},"".concat(t.name,"_").concat(t.위치))})]})})]})]})}},8819:e=>{e.exports={header:"Main_header__spRhi",logo:"Main_logo__XbNnm",menu:"Main_menu__NG9Dn",userMenu:"Main_userMenu__H7lmt",main:"Main_main__xfLto",pageTitle:"Main_pageTitle__Rv9tc",filterRow:"Main_filterRow__vM183",searchInput:"Main_searchInput__N0eT0",filterSelect:"Main_filterSelect__3lmVN",searchBtn:"Main_searchBtn__KP3XI",applyBtn:"Main_applyBtn__XZxi3",contentRow:"Main_contentRow__yFfRx",leftPanel:"Main_leftPanel__5WPOE",tabRow:"Main_tabRow__nUmVn",tabActive:"Main_tabActive__lVoeE",yearInfo:"Main_yearInfo__lRjjQ",placeCard:"Main_placeCard__85wC7",placeHeader:"Main_placeHeader__7_kYF",placeLogo:"Main_placeLogo__CuaA0",placeName:"Main_placeName__4e1Tm",placeType:"Main_placeType__Uor9k",starBtn:"Main_starBtn__AVLVd",placeInfo:"Main_placeInfo__utfQ7",infoNum:"Main_infoNum___kRuL",placeFooter:"Main_placeFooter__hS7_v",linkBtn:"Main_linkBtn__1S11h",authContainer:"Main_authContainer__46NWp",inputBox:"Main_inputBox__1lPYB",authButton:"Main_authButton__FlRHR",headerHidden:"Main_headerHidden__Rt8yR",headerVisible:"Main_headerVisible__TfvH8",highRating:"Main_highRating__MuZjg",lowRating:"Main_lowRating__wmLLu",newBadge:"Main_newBadge__3623I",favOn:"Main_favOn__G8Vdx"}}},e=>{var n=n=>e(e.s=n);e.O(0,[739,636,593,792],()=>n(2936)),_N_E=e.O()}]);