(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[588],{546:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return n}});let n=e=>{}},1393:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let a=n(4232),r=a.useLayoutEffect,i=a.useEffect;function o(e){let{headManager:t,reduceComponentsToState:n}=e;function o(){if(t&&t.mountedInstances){let r=a.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(n(r,e))}}return r(()=>{var n;return null==t||null==(n=t.mountedInstances)||n.add(e.children),()=>{var n;null==t||null==(n=t.mountedInstances)||n.delete(e.children)}}),r(()=>(t&&(t._pendingUpdate=o),()=>{t&&(t._pendingUpdate=o)})),i(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},5648:(e,t)=>{"use strict";function n(e){let{ampFirst:t=!1,hybrid:n=!1,hasQuery:a=!1}=void 0===e?{}:e;return t||n&&a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return n}})},6969:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>f});var a=n(7876),r=n(7328),i=n.n(r),o=n(9099),l=n(4232),s=n(1162),d=n(1724),c=n(4234),u=n(8819),p=n.n(u);function f(){let e=(0,o.useRouter)(),{placeId:t}=e.query,n=(0,l.useContext)(s.R),[r,u]=(0,l.useState)(0),[f,_]=(0,l.useState)(0),[h,m]=(0,l.useState)(""),[g,x]=(0,l.useState)([]),[y,b]=(0,l.useState)(0),[j,v]=(0,l.useState)(!1),[w,M]=(0,l.useState)(""),S=e=>(null==e?void 0:e.toDate)?e.toDate().toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",weekday:"short"}):"알 수 없음",k=async()=>{try{let e=await fetch("/data/places.json"),n=(await e.json()).find(e=>e.url===t);M(n?n.name:"알 수 없는 장소")}catch(e){console.error("가게 이름 불러오기 실패:",e),M("알 수 없는 장소")}},C=async()=>{try{let e=await fetch("/api/loadReviews?placeId=".concat(encodeURIComponent(t))),a=await e.json(),r=(Array.isArray(a.reviews)?a.reviews:[]).sort((e,t)=>e.user===n.email?-1:1);if(x(r),r.length){let e=r.reduce((e,t)=>e+t.rating,0)/r.length;b(e.toFixed(1))}let i=r.find(e=>e.user===n.email);i?(u(i.rating),m(i.text),v(!0)):(u(0),m(""),v(!1))}catch(e){console.error("리뷰 로딩 실패:",e),x([]),b(0)}};(0,l.useEffect)(()=>{t&&n&&(k(),C())},[t,n]);let R=async()=>{if(!r||r<1||r>5)return alert("1~5 사이의 평점을 선택해주세요.");if(!h.trim()||h.length<10)return alert("리뷰는 최소 10자 이상 입력해주세요.");let a={placeId:t,user:n.email,rating:r,text:h.trim()};try{let t=await fetch("/api/saveReview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),n=await t.json();t.ok?(alert(n.message),await C(),e.replace("/")):alert("리뷰 저장 실패: "+n.message)}catch(e){alert("서버 오류로 리뷰 저장 실패"),console.error(e)}},O=async()=>{await (0,d.CI)(c.j),alert("로그아웃 되었습니다."),e.push("/")};return n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsxs)("title",{children:["리뷰 남기기 - ",w]})}),(0,a.jsxs)("header",{className:p().header,children:[(0,a.jsx)("div",{className:p().logo,onClick:()=>e.push("/"),children:"KNUMAP"}),(0,a.jsxs)("nav",{className:p().menu,children:[(0,a.jsx)("button",{onClick:()=>e.push("/partner"),children:"제휴"}),(0,a.jsx)("button",{onClick:()=>e.push("/social"),children:"소셜"}),(0,a.jsx)("button",{onClick:()=>e.push("/favorite"),children:"즐겨찾기"})]}),(0,a.jsxs)("div",{className:p().userMenu,children:[(0,a.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e.push("/profile")},children:"내 정보"}),(0,a.jsx)("span",{style:{margin:"0 6px"},children:"|"}),(0,a.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),O()},children:"로그아웃"})]})]}),(0,a.jsxs)("main",{className:p().main,children:[(0,a.jsxs)("div",{style:{textAlign:"center",fontSize:20,fontWeight:"bold",padding:"12px 0",margin:"20px auto 30px",color:"#333",background:"rgba(255,255,255,0.85)",borderRadius:8,maxWidth:500,boxShadow:"0 2px 6px rgba(0,0,0,0.1)"},children:["리뷰 남기기 ",w?"- ".concat(w):""]}),(0,a.jsxs)("div",{style:{padding:30,background:"#fff",borderRadius:12,maxWidth:600,margin:"0 auto 40px",boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[y>0&&(0,a.jsxs)("div",{style:{textAlign:"center",marginBottom:20,fontSize:18},children:["평균 평점: ",(0,a.jsx)("strong",{children:y})," / 5.0"]}),j&&(0,a.jsx)("div",{style:{textAlign:"center",marginBottom:12,fontSize:14,color:"#3399ff"},children:"✏️ 이미 작성한 리뷰를 수정하고 있어요."}),(0,a.jsx)("div",{style:{marginBottom:20,textAlign:"center"},children:[1,2,3,4,5].map(e=>(0,a.jsx)("span",{onClick:()=>u(e),onMouseEnter:()=>_(e),onMouseLeave:()=>_(0),style:{fontSize:36,cursor:"pointer",textShadow:"0 2px 5px rgba(0,0,0,0.2)",color:(f||r)>=e?"#ffc107":"#e0e0e0",margin:"0 6px",transition:"transform 0.2s"},children:"★"},e))}),(0,a.jsx)("textarea",{value:h,onChange:e=>m(e.target.value),placeholder:"리뷰 내용을 입력하세요 (10자 이상, 300자 이하)",rows:5,maxLength:300,style:{width:"100%",padding:12,border:"1px solid #ccc",borderRadius:8,resize:"vertical",fontSize:14,marginBottom:10}}),(0,a.jsxs)("p",{style:{fontSize:12,color:"#999",marginBottom:20},children:[h.length," / 300자"]}),(0,a.jsx)("button",{onClick:R,style:{width:"100%",padding:"12px 0",backgroundColor:"#D90E15",color:"#fff",border:"none",borderRadius:6,fontSize:16,cursor:"pointer",fontWeight:"bold"},children:j?"리뷰 수정하기":"리뷰 제출하기"})]}),g.length>0&&(0,a.jsxs)("div",{style:{maxWidth:600,margin:"0 auto",background:"#fff",padding:30,borderRadius:12,boxShadow:"0 0 10px rgba(0,0,0,0.1)"},children:[(0,a.jsx)("h4",{children:"\uD83D\uDCCB 사용자 리뷰 목록"}),(0,a.jsx)("ul",{style:{listStyle:"none",padding:0},children:g.map((e,r)=>(0,a.jsxs)("li",{style:{background:e.user===n.email?"#e8f4ff":"#f9f9f9",padding:16,borderRadius:8,marginBottom:12,boxShadow:"0 1px 3px rgba(0,0,0,0.05)",border:e.user===n.email?"1px solid #3399ff":"none"},children:[(0,a.jsxs)("div",{style:{fontWeight:"bold"},children:[e.user===n.email?"\uD83D\uDCDD 내 리뷰":e.user," - ",e.rating,"점"]}),(0,a.jsx)("div",{style:{fontSize:14,color:"#555"},children:e.text}),(0,a.jsxs)("div",{style:{fontSize:12,color:"#999",marginTop:4},children:["작성일: ",S(e.date)]}),(0,a.jsx)("div",{style:{marginTop:8},children:e.user===n.email?(0,a.jsx)("button",{onClick:async()=>{confirm("정말 삭제하시겠어요?")&&(await fetch("/api/deleteReview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({placeId:t,user:n.email})}),alert("리뷰가 삭제되었습니다."),await C())},style:{fontSize:12,color:"#d00",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"삭제"}):(0,a.jsx)("button",{onClick:async()=>{confirm("이 리뷰를 정말 신고하시겠어요?")&&(await fetch("/api/reportReview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({placeId:t,reportedUser:e.user,reason:"사용자 수동 신고"})}),alert("신고가 접수되었습니다."))},style:{fontSize:12,color:"#999",background:"none",border:"none",cursor:"pointer",textDecoration:"underline"},children:"신고"})})]},r))})]})]})]}):(0,a.jsx)("p",{style:{padding:40},children:"로그인이 필요합니다."})}},7328:(e,t,n)=>{e.exports=n(9836)},7436:(e,t,n)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/review",function(){return n(6969)}])},8819:e=>{e.exports={header:"Main_header__spRhi",logo:"Main_logo__XbNnm",menu:"Main_menu__NG9Dn",userMenu:"Main_userMenu__H7lmt",main:"Main_main__xfLto",pageTitle:"Main_pageTitle__Rv9tc",filterRow:"Main_filterRow__vM183",searchInput:"Main_searchInput__N0eT0",filterSelect:"Main_filterSelect__3lmVN",searchBtn:"Main_searchBtn__KP3XI",applyBtn:"Main_applyBtn__XZxi3",contentRow:"Main_contentRow__yFfRx",leftPanel:"Main_leftPanel__5WPOE",tabRow:"Main_tabRow__nUmVn",tabActive:"Main_tabActive__lVoeE",yearInfo:"Main_yearInfo__lRjjQ",placeCard:"Main_placeCard__85wC7",placeHeader:"Main_placeHeader__7_kYF",placeLogo:"Main_placeLogo__CuaA0",placeName:"Main_placeName__4e1Tm",placeType:"Main_placeType__Uor9k",starBtn:"Main_starBtn__AVLVd",placeInfo:"Main_placeInfo__utfQ7",infoNum:"Main_infoNum___kRuL",placeFooter:"Main_placeFooter__hS7_v",linkBtn:"Main_linkBtn__1S11h",authContainer:"Main_authContainer__46NWp",inputBox:"Main_inputBox__1lPYB",authButton:"Main_authButton__FlRHR",headerHidden:"Main_headerHidden__Rt8yR",headerVisible:"Main_headerVisible__TfvH8",highRating:"Main_highRating__MuZjg",lowRating:"Main_lowRating__wmLLu",newBadge:"Main_newBadge__3623I",favOn:"Main_favOn__G8Vdx"}},9099:(e,t,n)=>{e.exports=n(8253)},9836:(e,t,n)=>{"use strict";var a=n(5364);Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{default:function(){return m},defaultHead:function(){return p}});let r=n(4252),i=n(8365),o=n(7876),l=i._(n(4232)),s=r._(n(1393)),d=n(9896),c=n(6834),u=n(5648);function p(e){void 0===e&&(e=!1);let t=[(0,o.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,o.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function f(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===l.default.Fragment?e.concat(l.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}n(546);let _=["name","httpEquiv","charSet","itemProp"];function h(e,t){let{inAmpMode:n}=t;return e.reduce(f,[]).reverse().concat(p(n).reverse()).filter(function(){let e=new Set,t=new Set,n=new Set,a={};return r=>{let i=!0,o=!1;if(r.key&&"number"!=typeof r.key&&r.key.indexOf("$")>0){o=!0;let t=r.key.slice(r.key.indexOf("$")+1);e.has(t)?i=!1:e.add(t)}switch(r.type){case"title":case"base":t.has(r.type)?i=!1:t.add(r.type);break;case"meta":for(let e=0,t=_.length;e<t;e++){let t=_[e];if(r.props.hasOwnProperty(t))if("charSet"===t)n.has(t)?i=!1:n.add(t);else{let e=r.props[t],n=a[t]||new Set;("name"!==t||!o)&&n.has(e)?i=!1:(n.add(e),a[t]=n)}}}return i}}()).reverse().map((e,t)=>{let r=e.key||t;if(a.env.__NEXT_OPTIMIZE_FONTS&&!n&&"link"===e.type&&e.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(t=>e.props.href.startsWith(t))){let t={...e.props||{}};return t["data-href"]=t.href,t.href=void 0,t["data-optimized-fonts"]=!0,l.default.cloneElement(e,t)}return l.default.cloneElement(e,{key:r})})}let m=function(e){let{children:t}=e,n=(0,l.useContext)(d.AmpStateContext),a=(0,l.useContext)(c.HeadManagerContext);return(0,o.jsx)(s.default,{reduceComponentsToState:h,headManager:a,inAmpMode:(0,u.isInAmpMode)(n),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9896:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return a}});let a=n(4252)._(n(4232)).default.createContext({})}},e=>{var t=t=>e(e.s=t);e.O(0,[636,593,792],()=>t(7436)),_N_E=e.O()}]);